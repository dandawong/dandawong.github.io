<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MSFM</title>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"> </script>
</head>
<body>
<img src="3.jpeg" id="img1">
<canvas id="canvas"></canvas>
</body>
<script>
// function predict()
// {
//   img.onload = () => {
//     const t = tf.browser.fromPixels(img, 3)
//     t.print()
//     const x = tf.expandDims(t)
//     const normalized = tf.image.resizeBilinear(x, [180, 180]).toFloat().div(tf.scalar(255))
//     console.log(normalized.shape)
//     const pred = model.predict(normalized).dataSync()
//     console.log(pred)
//   }
// }

// start()

// const canvas = document.getElementById('canvas');
// const ctx = canvas.getContext('2d');
// var img = new Image();
// img.crossOrigin = "Anonymous";
// img.src = "https://m.marine.gov.mo/displayinfo/dataCamLink.aspx?foldername=PI-02";
// img.onload = function() {
//   console.log('v1');
//   parseImage(img);
// };

// console.log('parseing')
// parseImage(document.getElementById("img1"));
parseImage(document.getElementById("img1"));

async function parseImage(img) {
  model = await tf.loadLayersModel('model/model.json')
  // predict()
  const t = tf.browser.fromPixels(img, 3)
  const x = tf.expandDims(t)
  const normalized = tf.image.resizeBilinear(x, [180, 180]).toFloat().div(tf.scalar(255))
  normalized.print()
  console.log(normalized.shape)
  const pred = model.predict(normalized).dataSync()
  console.log(pred)
}

</script>
</html>